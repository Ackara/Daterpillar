/* ADD ([tbl1].[]) SCRIPT */
PRAGMA foreign_keys = 0;
CREATE TABLE [tbl1_temp_table] AS SELECT * FROM [tbl1];
DROP TABLE [tbl1];

CREATE TABLE IF NOT EXISTS [tbl1]
(
	[Id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	[Name] VARCHAR(64) NOT NULL,
	[CategoryId] INTEGER NOT NULL,
	CONSTRAINT [tbl1_categoryid_to_tbl2_id_fkey1] FOREIGN KEY ([CategoryId]) REFERENCES [tbl2]([Id]) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE INDEX IF NOT EXISTS [cat_idx] ON [tbl1] ([CategoryId] ASC);

INSERT INTO [tbl1] ([Id], [Name], [CategoryId]) SELECT [Id], [Name], [CategoryId] FROM [tbl1_temp_table];
DROP TABLE [tbl1_temp_table];
PRAGMA foreign_keys = 1;
/* END SCRIPT */
