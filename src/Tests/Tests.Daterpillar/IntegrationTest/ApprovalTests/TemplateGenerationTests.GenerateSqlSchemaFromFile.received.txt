IF (db_id('zune') IS NOT NULL) DROP DATABASE [zune];
CREATE DATABASE [zune];

-- ------------------------------------
-- CREATE GENRE TABLE
-- ------------------------------------
CREATE TABLE [zune].[dbo].[genre]
(
	Id INT NOT NULL PRIMARY KEY IDENTITY(1, 1),
	Name VARCHAR(64) 
);

-- ------------------------------------
-- CREATE ARTIST TABLE
-- ------------------------------------
CREATE TABLE [zune].[dbo].[artist]
(
	Id INT NOT NULL PRIMARY KEY IDENTITY(1, 1),
	Name VARCHAR(64) NOT NULL,
	Bio TEXT 
);

-- ------------------------------------
-- CREATE ALBUM TABLE
-- ------------------------------------
CREATE TABLE [zune].[dbo].[album]
(
	Artist_Id INT NOT NULL,
	Name VARCHAR(64) NOT NULL,
	Release_Date DATE ,
	CONSTRAINT [album_artist_id_to_id_id_fkey1] FOREIGN KEY ([Artist_Id]) REFERENCES [artist]([Id])
);

ALTER TABLE [zune].[dbo].[album] ADD CONSTRAINT [zune_album_pk] PRIMARY KEY (Artist_Id ASC, Name ASC);
CREATE INDEX [zune_album_idx2] ON [zune].[dbo].[album] (Artist_Id ASC, Name ASC);
-- ------------------------------------
-- CREATE SONG TABLE
-- ------------------------------------
CREATE TABLE [zune].[dbo].[song]
(
	Id INT NOT NULL PRIMARY KEY IDENTITY(1, 1),
	Album_Id INT NOT NULL,
	Artist_Id INT NOT NULL,
	Genre_Id INT NOT NULL,
	Name VARCHAR(64) NOT NULL,
	Length DECIMAL(4, 2) ,
	Price DECIMAL(12, 2) NOT NULL,
	On_Device BIT NOT NULL DEFAULT '0',
	CONSTRAINT [song_genre_id_to_id_id_fkey3] FOREIGN KEY ([Genre_Id]) REFERENCES [genre]([Id]),
	CONSTRAINT [song_artist_id_to_id_id_fkey4] FOREIGN KEY ([Artist_Id]) REFERENCES [artist]([Id])
);

